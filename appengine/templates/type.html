{% extends "base.html" %}
{% set css_name = "css/model.css" %}
{% block content %}

    <div class = "results"></div>
    <script>
      var result = "";
      var parameters = location.search.substring(1);

      var temp = parameters.split("=");
      name = decodeURI(temp[1]);
      result = "<h1>" + name + "</h1>";

      var iframe = document.createElement('iframe');
      iframe.id = 'iframe';
      iframe.style.display = 'none';
      document.body.appendChild(iframe);
      iframe.src = 'static/JSONs/types.json';

      var iframe2 = document.createElement('iframe');
      iframe2.id = 'iframe2';
      iframe2.style.display = 'none';
      document.body.appendChild(iframe2);
      iframe2.src = 'static/JSONs/works.json';

      var iframe3 = document.createElement('iframe');
      iframe3.id = 'iframe3';
      iframe3.style.display = 'none';
      document.body.appendChild(iframe3);
      iframe3.src = 'static/JSONs/artists.json';

      var json;
      var json2;
      var json3;

      setTimeout(function() {
        var types = document.getElementById('iframe').contentDocument.body.firstChild.innerHTML;
        json = JSON.parse(types);

        var works = document.getElementById('iframe2').contentDocument.body.firstChild.innerHTML;
        json2 = JSON.parse(works);

        var artists = document.getElementById('iframe3').contentDocument.body.firstChild.innerHTML;
        json3 = JSON.parse(artists);

        for (var key in json) {
          var val = json[key];
          for(var key2 in val) {
            var obj = val[key2];
            if(obj.name === name) {
              for(var med in obj.mediums) {
                result += obj.mediums[med] + "<br>";
              }

              result += "<br><h2>Notable Works</h2><br>"
              for(var i in json2) {
                var val2 = json2[i];
                for(var j in val2) {
                  var work = val2[j];
                  if(obj.notable_examples.includes(work.work_id)) {
                    result += "<a href=work?name=" + encodeURI(work.name) + ">" + work.name + "</a><br><br>";
                  }
                }
              }

              result += "<h2>Notable Arists</h2><br>"
              for(var k in json3) {
                var val3 = json3[k];
                for(var l in val3) {
                  var artist = val3[l];
                  if(obj.notable_artists.includes(artist.artist_id)) {
                    result += "<a href=artist?name=" + encodeURI(artist.name) + ">" + artist.name + "</a><br><br>";
                  }
                }
              }
            }
          }
        }
        document.querySelector('.results').innerHTML = result;
      }, 500);
    </script>

{% endblock %}
